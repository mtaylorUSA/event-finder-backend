\# Event Finder - Workflow Documentation



Last Updated: 2025-12-04



This document describes the end-to-end workflow for the Event Finder project.



---



\## Overview



The Event Finder workflow has 3 main phases:



1\. \*\*Organization Discovery\*\* - Finding organizations to scrape

2\. \*\*Permission Management\*\* - Getting legal permission to scrape

3\. \*\*Event Scraping\*\* - Collecting and enriching event data



---



\## Phase 1: Organization Discovery



\### Automatic Discovery (AI)



1\. Run `suggest-organizations.js`

2\. AI analyzes existing approved organizations

3\. AI suggests similar organizations in national security space

4\. New orgs saved with status = `Pending Mission Review`



\### Manual Discovery



1\. Open PocketBase Admin or `admin-interface.html`

2\. Click "Add Organization"

3\. Enter organization details

4\. Set status = `Pending Mission Review`

5\. Save



\### Mission Review



1\. Open "Pending Review" tab in admin interface

2\. For each organization:

&nbsp;  - Review website and mission

&nbsp;  - Check if fits national security focus

&nbsp;  - Check TOU flag (⚠️) if present

3\. Decision:

&nbsp;  - ✅ \*\*Approve\*\*: Status → `Mission Approved Pending Permission`

&nbsp;  - ❌ \*\*Reject\*\*: Status → `Mission Rejected`



---



\## Phase 2: Permission Management



\### Add POC Contacts



For each approved organization:



1\. Research POC contact info:

&nbsp;  - Check website footer, "Contact Us" page

&nbsp;  - Look for permissions@, legal@, events@ emails

&nbsp;  - Find staff directory for relevant contacts

2\. Add contact via admin interface or `add-contacts.js`

3\. Contact types:

&nbsp;  - `Legal/Permissions` - Best for permission requests

&nbsp;  - `Events` - Alternative contact

&nbsp;  - `Media/PR` - Fallback option

&nbsp;  - `Leadership` - Last resort

&nbsp;  - `Other` - General inquiries



\### Generate Permission Request Drafts



1\. Run `generate-permission-requests.js`

2\. Script automatically:

&nbsp;  - Pulls your info from `settings` collection

&nbsp;  - Finds best contact for each org (Legal/Permissions > Events > Other)

&nbsp;  - Generates customized email draft

&nbsp;  - Saves to `permission\_request\_draft` field



\### Review and Send Permission Requests



1\. Open PocketBase Admin

2\. Go to organizations collection

3\. Filter by status = `Mission Approved Pending Permission`

4\. For each organization:

&nbsp;  - Open record

&nbsp;  - Review `permission\_request\_draft` field

&nbsp;  - Copy draft to email client

&nbsp;  - Edit if needed

&nbsp;  - Send email

5\. After sending:

&nbsp;  - Update status → `Permission Requested (Self)` or `Permission Requested (Lawyer)`

&nbsp;  - Set `permission\_requested\_date` to today



\### Handle Responses



\*\*If Permission Granted:\*\*

1\. Paste approval email into `permission\_correspondence` field

2\. Update status → `Permission Granted`

3\. Set `permission\_response\_date` to today

4\. Set `scraping\_enabled` = true

5\. Update status → `Scraping Active`



\*\*If Permission Rejected:\*\*

1\. Paste rejection email into `permission\_correspondence` field

2\. Update status → `Permission Rejected`

3\. Set `permission\_response\_date` to today



\*\*If No Response (after 2 weeks):\*\*

1\. Send follow-up email

2\. Add note to `permission\_correspondence` field



---



\## Phase 3: Event Scraping



\### Enable Scraping



Prerequisites:

\- Status = `Permission Granted` or `Scraping Active`

\- `scraping\_enabled` = true

\- `events\_url` is set



\### Run Scrapers



\*\*Option A: Scrape All Enabled Organizations\*\*

```powershell

node scrape-all-organizations.js

```



\*\*Option B: Scrape Specific Organization\*\*

```powershell

node scrape-cfr-events.js

node scrape-cisa-events.js

node scrape-insa-events.js

```



\### Scraper Behavior



1\. Fetches events page from `events\_url`

2\. Parses event data (title, date, time, location, URL)

3\. Checks for duplicates by `source\_id`

4\. Saves new events to `events` collection

5\. Updates `last\_scraped` timestamp on organization



\### Enrich Events (Optional)



After scraping, run AI enrichment:

```powershell

node enrich-events.js

```



This adds:

\- Topic tags

\- Event type classification

\- Speaker extraction



\### Generate Embeddings (Optional)



For semantic search:

```powershell

node generate-embeddings.js

```



This creates vector embeddings for event search.



---



\## Maintenance Tasks



\### Cleanup Orphaned Events



Remove events whose organization was deleted:

```powershell

node cleanup-orphaned-events.js

```



\### Cleanup Bad Events



Remove events with missing required fields:

```powershell

node cleanup-bad-events.js

```



---



\## Status Reference



| Status | Can Edit? | Can Scrape? | Next Action |

|--------|-----------|-------------|-------------|

| Pending Mission Review | Yes | No | Review and approve/reject |

| Mission Approved Pending Permission | Yes | No | Send permission request |

| Mission Rejected | Yes | No | None (end state) |

| Permission Requested (Self) | Yes | No | Wait for response |

| Permission Requested (Lawyer) | Yes | No | Wait for response |

| Permission Granted | Yes | Yes | Enable scraping |

| Permission Rejected | Yes | No | None (end state) |

| Scraping Active | Yes | Yes | Monitor and maintain |



---



\## Quick Reference: Common Tasks



\### Add a New Organization

1\. Admin interface → "Add Organization"

2\. Fill in details, set status = `Pending Mission Review`

3\. Save



\### Approve an Organization

1\. Admin interface → "Pending Review" tab

2\. Click "✅ Approve Mission"

3\. Status changes to `Mission Approved Pending Permission`



\### Send Permission Request

1\. Run `generate-permission-requests.js`

2\. Open org in PocketBase

3\. Copy `permission\_request\_draft`

4\. Send email

5\. Update status to `Permission Requested (Self)`



\### Enable Scraping After Approval

1\. Open org in PocketBase

2\. Set `scraping\_enabled` = true

3\. Set status = `Scraping Active`

4\. Run `node scrape-all-organizations.js`



\### Check Scraping Results

1\. Admin interface → "Events" tab

2\. Filter by organization

3\. Review scraped events



---



\## Workflow Diagram

```

┌──────────────────────────────────────────────────────────────────────────┐

│                                                                          │

│   ┌─────────────┐     ┌─────────────────────┐     ┌─────────────────┐   │

│   │ AI Suggests │────▶│ Pending Mission     │────▶│ Mission         │   │

│   │ Organization│     │ Review              │     │ Rejected        │   │

│   └─────────────┘     └──────────┬──────────┘     └─────────────────┘   │

│                                  │                                       │

│                                  ▼                                       │

│                       ┌─────────────────────┐                           │

│                       │ Mission Approved    │                           │

│                       │ Pending Permission  │                           │

│                       └──────────┬──────────┘                           │

│                                  │                                       │

│                                  ▼                                       │

│                       ┌─────────────────────┐     ┌─────────────────┐   │

│                       │ Permission          │────▶│ Permission      │   │

│                       │ Requested           │     │ Rejected        │   │

│                       └──────────┬──────────┘     └─────────────────┘   │

│                                  │                                       │

│                                  ▼                                       │

│                       ┌─────────────────────┐                           │

│                       │ Permission          │                           │

│                       │ Granted             │                           │

│                       └──────────┬──────────┘                           │

│                                  │                                       │

│                                  ▼                                       │

│                       ┌─────────────────────┐                           │

│                       │ Scraping            │◀──┐                       │

│                       │ Active              │───┘ (recurring)           │

│                       └─────────────────────┘                           │

│                                                                          │

└──────────────────────────────────────────────────────────────────────────┘

```



---



\## Related Documentation



\- `PocketBase-UI-Reference.md` - How to use PocketBase admin

\- `PocketBase-Schema.md` - Database field details

\- `Running-Scripts.md` - How to execute scripts

\- `Event-Finder-Context.md` - Project overview

